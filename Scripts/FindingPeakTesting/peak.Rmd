---
title: "findingPeakTesting"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
rowSums <-readRDS("~/Magneto2020/rowSums19260902")
write.csv(rowSums, file = "~/Magneto2020/rowSums19260902.csv")
```

```{r}


threshold <- (0.4*(mean(rowSums)))
fivePercent <- 0.05*max(rowSums)

pracemaPeaks <- findpeaks(rowSums, npeaks = 4, threshold = threshold , sortstr = FALSE, minpeakheight = fivePercent)
pracemaPeaks

plot(rowSums, type = "l", col = "navy")
points(x = Peaks[,2], y = Peaks[,1], pch = 20, col = "red")
abline(v = c(Peaks[,3], Peaks[,4]), lty = 2, col = "green")


```

```{r}
max(rowSums)
which(rowSums == max(rowSums))
```
## check to see if we got all the peaks

```{r}
checkingPeaks <- function(pracemaPeaks, rowSums, numPeaksWanted){
  library("pracma")
  
  numPeaksFound <- dim(pracemaPeaks)[1]
  bounds <- vector()
  minHight <- 0.05*max(pracemaPeaks)
  if (NumPeaksWanted > numPeaksFound) {
    for (i in 1:numPeaksFound) {
      bounds <- c(bounds,pracemaPeaks[i,3]:pracemaPeaks[i,4])
    }
      
    rowSumsWOPeaks <- rowSums[-bounds]
    threshold <- (0.4*(mean(rowSumsWOPeaks)))
    extraPeaks <- findpeaks(rowSums, npeaks = 4, threshold = threshold ,
                                sortstr = FALSE, minpeakheight = minHight)
    if (is.null(extraPeaks)) {
      return("Couldn't find anymore peaks")
    }
    if (numPeaksWanted == numPeaksFound + 1) {
      extraPeak <- which(Peaks == max(Peaks[,1]))
      return(extraPeaks[extraPeak,])
    }
    #TODO figure out how to make this recursive.. don't nessasarly know how many they wanted..( or even if that should be a parameter)
  
  }
  else{
    
  }  
      
  
}
```

```{r}

```

