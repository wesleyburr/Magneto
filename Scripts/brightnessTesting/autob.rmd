---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
library("png")
library("knitr")

```



```{r}

pngs <- read.table("~/txtFiles/pngsFinal.txt")
```
```{r}
i = 1
userOpinion1162  = vector()
```

```{r}
image_import <- function(image,file_loc){
  readTIFF(paste0(file_loc,"/",image))
}

```


```{r}

i = 0
for (i in 1:116){
userOpinion1162[i] <- readline(prompt = "Is this image bright(1), good(0)")
  
}

```

```{r}
brightnessFirst1162 <- 
read.csv("~/Magneto2020/DataCSV/pngTODOTesting.csv", header = TRUE, stringsAsFactors = FALSE)

above.8 <- vector()
total <- vector()
standard <- vector()
for (i in 1:116){
  name <- brightnessFirst1162$ImageName[i]
  path <- brightnessFirst1162$ImagePath[i]
  image <- image_import(name,path)
  
  above.8[i] <- length(which(image >= 0.75))
  total[i] <- length(image)
  standard[i] <- above.8[i]/total[i]
}
```

```{r}
xvals = 1:116
Images <- data.frame(standard, userOpinion1162)
plot(x = xvals, y = Images$standard, col = Images$userOpinion1162)
legend(x = "bottomright", legend = paste0("image:", c("bright", "good")),
fill = c("black", "red"))
abline(v = 10)
```

```{r}
forlm <- data.frame(standard, userOpinion1162)
lmod <- glm(userOpinion1162 ~ standard, data = forlm, family = binomial)
summary(lmod)
plot(lmod, which = 1:6)
```
# Finding the McFadden Pseudo- $R^2$ Value

```{r}
nullmodel <- glm(userOpinion1162~1, family = binomial,  data = forlm)

1-logLik(lmod)/logLik(nullmodel)
```


