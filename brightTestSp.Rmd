---
title: "brightnessTestsp.Rmd"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
image_import <- function(image,file_loc){
  readTIFF(paste0(file_loc,"/",image))
}
```
# Individual histograms
(base one for the first conparison)
```{r }
library("png")
library("tiff")
library("knitr")
DigitizationTODO <- read.csv("~/Magneto2020/DataCSV/200615_pngTODOB3.csv", header = FALSE, stringsAsFactors = FALSE)
names(DigitizationTODO) <- c("ImagePath", "ImageName", "DigitizedYet", "DigitizationPath", "DigitizationName", "ErrorWhenDigitized")
i = 1
temp <- readPNG(paste0(DigitizationTODO$ImagePath[i], DigitizationTODO$ImageName[i]))
hist(temp, breaks = 60)
 
knitr::include_graphics(paste0(DigitizationTODO$ImagePath[i], DigitizationTODO$ImageName[i]))

```
```{r mm.486-gm0.00353}

i = 1
fileWithPath <- "~/Magneto2020/ImagesPNG/AGC-HDZ-19430207-19430208.tif.png" #.486
temp <- readPNG(fileWithPath)
hist(temp, breaks = 60)
 
knitr::include_graphics(fileWithPath)

```


## mm.486-gm0.00353 comp
```{r comp}
fileWithPath1 <- "~/Magneto2020/ImagesPNG/AGC-HDZ-19430207-19430208.tif.png" #0.486
fileWithPath2 <- "~/Magneto2020/ImagesPNG/AGC--H-19260101-19260103.tif.png"
temp1 <- readPNG(fileWithPath1)
temp2 <- readPNG(fileWithPath2)
Mat1 <- data.frame(Range = temp1)
Mat2 <- data.frame(Range = temp2)

Mat1$name <- "image 1"
Mat2$name <- "image 2"

knitr::include_graphics(fileWithPath1)
knitr::include_graphics(fileWithPath2)
hist(temp1)
hist(temp2, add = TRUE, border = "red")

```


## mm.0420-gm0.0061353
```{r mm.0420-gm0.0061353comp}
fileWithPath1 <- "~/Magneto2020/ImagesPNG/AGC-HDZ-19430207-19430208.tif.png" #0.486
fileWithPath2 <- "~/Magneto2020/ImagesPNG/AGC-Z-19290121-19290123.tif.png" #0.0420
temp1 <- readPNG(fileWithPath1)
temp2 <- readPNG(fileWithPath2)
Mat1 <- data.frame(Range = temp1)
Mat2 <- data.frame(Range = temp2)

Mat1$name <- "image 1"
Mat2$name <- "image 2"

knitr::include_graphics(fileWithPath1)
knitr::include_graphics(fileWithPath2)
hist(temp1)
hist(temp2, add = TRUE, border = "blue")
```

## mm. 0.0385
AGC-D-19310628-19310630.tif, sweet spot

```{r mm.0277_comp_mm.oneIchose}
fileWithPath1 <- "~/Magneto2020/ImagesPNG/AGC-D-19340912-19340914-Readme.tif.png" #0.0277
fileWithPath2 <- "~/Magneto2020/ImagesPNG/AGC-D-19310628-19310630.tif.png" #0.0385red one
temp1 <- readPNG(fileWithPath1)
temp2 <- readPNG(fileWithPath2)


WithGauss <- t( apply(temp2, MARGIN = 1, FUN = deconvGauss, sig = 10, kern.trunc = 0.05, nw = 3 ) ) # done on the second image
writePNG(WithGauss,"~/tGauss.png")
gaussfile <- "~/tGauss.png"

knitr::include_graphics(fileWithPath1)
knitr::include_graphics(fileWithPath2)
knitr::include_graphics(gaussfile)


# plots
##full plot ----------------
hist(temp1, breaks = 100,
     ylim = c(0,4e6))
hist(temp2, add = TRUE, border = "red", , breaks = 100)
hist(WithGauss, add = TRUE, border = "blue")
legend(x = "topright", legend = paste0("image:", c("first", "second", "gauss on 2")),
fill = c("black", "red", "blue"))
##the low side ----------------
hist(temp1, breaks = 100,
     ylim = c(0,4e6),
    #ylim = c(0,2e5),
    #xlim = c(0.4,1))
    xlim = c(0,0.3))
hist(temp2, add = TRUE, border = "red", , breaks = 100)
hist(WithGauss, add = TRUE, border = "blue")
legend(x = "topright", legend = paste0("image:", c("first", "second", "gauss on 2")),
fill = c("black", "red", "blue"))

##the high side ----------------
hist(temp1, breaks = 100,
     #ylim = c(0,4e6),
     ylim = c(0,2e5),
     xlim = c(0.4,1))
    #xlim = c(0,0.4))
hist(temp2, add = TRUE, border = "red", , breaks = 100)
hist(WithGauss, add = TRUE, border = "blue")
legend(x = "topleft", legend = paste0("image:", c("first", "second", "gauss on 2")),
fill = c("black", "red", "blue"))

```



## mm.0227-gm0.0033 This one was not really readable
AGC-D-19340912-19340914-Readme.tif

```{r mm.0277_comp_mm.oneIchose}
fileWithPath1 <- "~/Magneto2020/ImagesPNG/AGC-D-19340912-19340914-Readme.tif.png" #0.0277
fileWithPath2 <- "~/Magneto2020/ImagesPNG/AGC-Z-19290121-19290123.tif.png" #0.0420red one
temp1 <- readPNG(fileWithPath1)
temp2 <- readPNG(fileWithPath2)

source("~/Magneto2020/Scripts/BreakoutOptimization.R")
WithGauss <- t( apply(temp2, MARGIN = 1, FUN = deconvGauss, sig = 10, kern.trunc = 0.05, nw = 3 ) ) # done on the second image
writePNG(WithGauss,"~/tGauss.png")
gaussfile <- "~/tGauss.png"

knitr::include_graphics(fileWithPath1)
knitr::include_graphics(fileWithPath2)
knitr::include_graphics(gaussfile)

# plots
##full plot ----------------
hist(temp1, breaks = 100,
     ylim = c(0,4e6))
hist(temp2, add = TRUE, border = "red", , breaks = 100)
hist(WithGauss, add = TRUE, border = "blue")
legend(x = "topright", legend = paste0("image:", c("first", "second", "gauss on 2")),
fill = c("black", "red", "blue"))
##the low side ----------------
hist(temp1, breaks = 100,
     ylim = c(0,4e6),
    #ylim = c(0,2e5),
    #xlim = c(0.4,1))
    xlim = c(0,0.3))
hist(temp2, add = TRUE, border = "red", , breaks = 100)
hist(WithGauss, add = TRUE, border = "blue")
legend(x = "topright", legend = paste0("image:", c("first", "second", "gauss on 2")),
fill = c("black", "red", "blue"))

##the high side ----------------
hist(temp1, breaks = 100,
     #ylim = c(0,4e6),
     ylim = c(0,2e5),
     xlim = c(0.4,1))
    #xlim = c(0,0.4))
hist(temp2, add = TRUE, border = "red", , breaks = 100)
hist(WithGauss, add = TRUE, border = "blue")
legend(x = "topleft", legend = paste0("image:", c("first", "second", "gauss on 2")),
fill = c("black", "red", "blue"))

```

## mm.0096-gm0.014
 
 
```{r mm.0420_comp_mm.0096}
fileWithPath1 <- "~/Magneto2020/ImagesPNG/AGC-Z-19290121-19290123.tif.png" #0.0420
fileWithPath2 <- "~/Magneto2020/ImagesPNG/AGC-Z-19370416-19370418.tif.png" #0.0096 red one
temp1 <- readPNG(fileWithPath1)
temp2 <- readPNG(fileWithPath2)

source("~/Magneto2020/Scripts/BreakoutOptimization.R")
WithGauss <- t( apply(temp2, MARGIN = 1, FUN = deconvGauss, sig = 10, kern.trunc = 0.05, nw = 3 ) )
writePNG(WithGauss,"~/tGauss.png")
gaussfile <- "~/tGauss.png"

knitr::include_graphics(fileWithPath1)
knitr::include_graphics(fileWithPath2)
knitr::include_graphics(gaussfile)

# plots --------
##full plot
hist(temp1, breaks = 100,
     ylim = c(0,4e6))
hist(temp2, add = TRUE, border = "red", , breaks = 100)
hist(WithGauss, add = TRUE, border = "blue")
legend(x = "topright", legend = paste0("image:", c("first", "second", "gauss on 2")),
fill = c("black", "red", "blue"))

##the low side
hist(temp1, breaks = 100,
     ylim = c(0,4e6),
    #ylim = c(0,2e5),
    #xlim = c(0.4,1))
    xlim = c(0,0.3))
hist(temp2, add = TRUE, border = "red", , breaks = 100)
hist(WithGauss, add = TRUE, border = "blue")
legend(x = "topright", legend = paste0("image:", c("first", "second", "gauss on 2")),
fill = c("black", "red", "blue"))

##the high side
hist(temp1, breaks = 100,
     #ylim = c(0,4e6),
     ylim = c(0,2e5),
     xlim = c(0.4,1))
    #xlim = c(0,0.4))
hist(temp2, add = TRUE, border = "red", , breaks = 100)
hist(WithGauss, add = TRUE, border = "blue")
legend(x = "topleft", legend = paste0("image:", c("first", "second", "gauss on 2")),
fill = c("black", "red", "blue"))
```
